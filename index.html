<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Murphy Family Codex</title>

<style>
/* ===== IDENTICAL TO MURPHYFAMILY UI ===== */
body {
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
  background: radial-gradient(1200px 700px at 15% -10%, #1a2340, transparent 55%),
              radial-gradient(1000px 600px at 85% 0%, #3a2f18, transparent 60%),
              #0b0f18;
  color:#e9eef8;
}
header {
  position:sticky;
  top:0;
  z-index:10;
  backdrop-filter: blur(10px);
  background: rgba(11,15,24,.82);
  border-bottom:1px solid #22304f;
}
header .bar {
  max-width:1200px;
  margin:0 auto;
  padding:16px 24px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
h1 {
  font-size:16px;
  margin:0;
}
small { color:#aab6d6 }
main {
  max-width:1200px;
  margin:0 auto;
  padding:24px;
}
.panel {
  background: linear-gradient(180deg, rgba(15,22,38,.95), rgba(15,22,38,.9));
  border:1px solid #22304f;
  border-radius:14px;
  padding:18px;
}
.toolbar {
  display:flex;
  gap:12px;
  flex-wrap:wrap;
}
input, select {
  background:#0b0f18;
  border:1px solid #22304f;
  color:#e9eef8;
  padding:10px 12px;
  border-radius:10px;
}
.section {
  margin-top:24px;
}
.section h2 {
  font-size:13px;
  color:#aab6d6;
  border-bottom:1px solid #22304f;
  padding-bottom:6px;
}
.item {
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:12px;
  margin-top:10px;
  border:1px solid #22304f;
  border-radius:10px;
  background:#0b0f18;
}
.item span {
  font-size:13px;
}
button, a.btn {
  background:#1a2340;
  border:1px solid #c9a24a;
  color:#e9eef8;
  padding:8px 12px;
  border-radius:10px;
  text-decoration:none;
  cursor:pointer;
}
</style>
</head>

<body>
<header>
  <div class="bar">
    <div>
      <h1>Murphy Family Codex</h1>
      <small>Family Archive Â· Private Index</small>
    </div>
  </div>
</header>

<main>
  <div class="panel">
    <div class="toolbar">
      <input id="search" placeholder="Search">
      <select id="category"></select>
    </div>
    <div id="content"></div>
  </div>
</main>

<script>
const OWNER = "CydnieT";
const REPO  = "FAMILYGARDEN";
const BRANCH = "main";
const FOLDERS = ["docs"];

let FILES = [];

function encode(p){ return p.split("/").map(encodeURIComponent).join("/"); }

function category(name){
  name = name.toLowerCase();
  if (name.includes("will") || name.includes("trust") || name.includes("attorney")) return "Estate";
  if (name.includes("health") || name.includes("directive")) return "Medical";
  if (name.includes("ds11") || name.includes("passport")) return "Identity";
  if (name.includes("bank") || name.includes("cpa")) return "Finance";
  return "Documents";
}

async function load(){
  const res = await fetch(
    `https://api.github.com/repos/${OWNER}/${REPO}/contents/docs?ref=${BRANCH}`
  );
  const data = await res.json();
  FILES = data
    .filter(f => f.type === "file" && /\.(pdf|html|zip|epub)$/i.test(f.name))
    .map(f => ({
      name: f.name.replace(/_/g," ").replace(/\.(pdf|html|zip|epub)$/i,""),
      path: "docs/" + f.name,
      cat: category(f.name)
    }));
  render();
}

function render(){
  const q = document.getElementById("search").value.toLowerCase();
  const c = document.getElementById("category").value;
  const byCat = {};
  FILES.forEach(f=>{
    if(q && !f.name.toLowerCase().includes(q)) return;
    if(c && f.cat !== c) return;
    (byCat[f.cat] ||= []).push(f);
  });

  const cont = document.getElementById("content");
  cont.innerHTML = "";
  Object.keys(byCat).sort().forEach(cat=>{
    const sec = document.createElement("div");
    sec.className="section";
    sec.innerHTML = `<h2>${cat}</h2>`;
    byCat[cat].forEach(f=>{
      const div = document.createElement("div");
      div.className="item";
      div.innerHTML = `
        <span>${f.name}</span>
        <span>
          <a class="btn" href="${encode(f.path)}" target="_blank">Open</a>
          <a class="btn" href="${encode(f.path)}" download>Download</a>
        </span>`;
      sec.appendChild(div);
    });
    cont.appendChild(sec);
  });

  const cats = [...new Set(FILES.map(f=>f.cat))];
  const sel = document.getElementById("category");
  sel.innerHTML = `<option value="">All</option>` +
    cats.map(c=>`<option>${c}</option>`).join("");
}

document.getElementById("search").oninput = render;
document.getElementById("category").onchange = render;

load();
</script>
</body>
</html>
